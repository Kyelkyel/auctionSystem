<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>KoolBulls Admin Panel</title>
  <!-- Thymeleaf resolves CSS path -->
  <link rel="stylesheet" th:href="@{/css/Admin.css}" />
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet"/>
</head>
<body>
  <div th:if="${session.if_admin == false}">
    <script th:inline="javascript">
        /*<![CDATA[*/
        window.location.href = /*[[@{/user}]]*/ '/user';
        /*]]>*/
    </script>
  </div>



<header>
    <div class="logo">KoolBulls Admin</div>
    
    <button id="menuBtn">☰</button>
      
    <div id="sidebar" class="sidebar">
      <button id="closeBtn">×</button>

      <div class="profile">
         <!-- Use Thymeleaf to resolve image src -->
         <img th:src="@{/images/pfptest.jpg}" alt="Profile picture" class="avatar"/>
         <div class="userinfo">
           <strong>Admin</strong>
           <span class="handle">Admin</span>
         </div>
      </div>
      <ul>
        <!-- Use th:href for internal links, adjust paths as needed -->
        <li><a th:href="@{/yourProfile}">Your profile</a></li>
        <li><a th:href="@{/auctionCreation}">Sell Items</a></li>
        <li><a th:href="@{/auctions}">Auctions</a></li>
        <li><a th:href="@{/settings}">Settings</a></li>
        <li><a th:href="@{/signout}">Sign out</a></li>
      </ul>
    </div>
</header>

<!-- Main content -->
<main class="admin-main">
  <div class="admin-panel">

    <!-- Dashboard -->
    <section class="dashboard" id="dashboard">
      <h2>Dashboard Overview</h2>
      <div class="dashboard-stats">
        <div class="stat">
          <h3 id="total-auctions">5</h3>
          <p>Total Auctions</p>
        </div>
        <div class="stat">
          <h3>10</h3>
          <p>Sold Items</p>
        </div>
        <div class="stat">
          <h3>4</h3>
          <p>Active Bids</p>
        </div>
      </div>
    </section>

  <!-- Manage Auctions -->
  <section class="manage-auctions" id="auction">
    <h2>Manage Auctions</h2>
    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Price</th>
          <th>Status</th>
          <th>Date Submitted</th>
          <th>Time</th>
          <th>Auctioneer</th>
          <th>Email</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="auction-list">
        <tr th:each="auctionCreationEntityVar : ${auctionList}">
          <td th:text="${auctionCreationEntityVar.auctionItem.itemTitle}">Apple MacBook Air</td>
          <td th:text="${#numbers.formatDecimal(auctionCreationEntityVar.currentPrice, 0, 0)}">₱6,269</td>

          <td th:text="${auctionCreationEntityVar.auctionStatus}">Upcoming</td>
          <td th:text="${#temporals.format(auctionCreationEntityVar.auctionItem.startTime, 'MMMM d, yyyy')}">June 9, 2025</td>
          <td th:text="${#temporals.format(auctionCreationEntityVar.auctionItem.startTime, 'h:mm a')}">12:00 PM</td>
          <td th:text="${auctionCreationEntityVar.auctionItem.sellerInfoName}">AuctioneerUsername</td>
          <td th:text="${auctionCreationEntityVar.auctionItem.sellerInfoEmail}">auctioneer@example.com</td>
          <td>
            <form th:action="@{'/deleteAuctionItem/' + ${auctionCreationEntityVar.auctionItem.auctionItemID}}" method="post" style="display:inline">
              <button type="submit">Delete</button>
            </form>
          </td>
        </tr>
      </tbody>
    </table>
  </section>

    <!-- Pending Items from Users -->
    <section class="pending-auctions" id="pending-items">
  <h2>Pending Items for Approval</h2>
  <table>
    <thead>
      <tr>
        <th>Image</th>
        <th>Title</th>
        <th>Description</th>
        <th>Seller</th>
        <th>Seller ID</th>
        <th>Date Submitted</th>
        <th>Time</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="pending-list">
      <tr th:each="auctionCreationEntityVar : ${auctionCreationEntityList}" th:if="${auctionCreationEntityVar.isVerified == false}">
        <td>
          <img th:src="${auctionCreationEntityVar.itemImage}" class="item-image" alt="Item Image" />
        </td>
        <td th:text="${auctionCreationEntityVar.itemTitle}">Title</td>
        <td th:text="${auctionCreationEntityVar.itemDescription}">Description</td>
        <td th:text="${auctionCreationEntityVar.sellerInfoEmail}">Seller</td>
        <td th:text="${auctionCreationEntityVar.userID}">Seller ID</td>
        <td th:text="${#temporals.format(auctionCreationEntityVar.startTime, 'MMMM d, yyyy')}">Date Submitted</td>
        <td th:text="${#temporals.format(auctionCreationEntityVar.startTime, 'h:mm a')}">Time</td>
        <td>
          <form th:action="@{'/approveAuctionItem/' + ${auctionCreationEntityVar.auctionItemID}}" method="post" style="display:inline">
            <button type="submit">Approve</button>
          </form>

          <form th:action="@{'/rejectAuctionItem/' + ${auctionCreationEntityVar.auctionItemID}}" method="post" style="display:inline">
            <button type="submit">Reject</button>
          </form>

          <!-- <button type="button" onclick="rejectItem(this)">Reject</button> -->
        </td>
      </tr>
    </tbody>
  </table>
</section>


    <!-- Winners -->
    <section class="manage-auctions" id="winners">
      <h2>Winning Bidders</h2>
      <table>
        <thead>
          <tr>
            <th>Item</th>
            <th>Winner</th>
            <th>Winning Bid</th>
            <th>Date Submitted</th>
            <th>Time</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>PlayStation 5</td>
            <td>user789</td>
            <td>₱21,000</td>
            <td>June 9, 2025</td>
            <td>12:00 PM</td>
            <td>Paid</td>
          </tr>
          <tr>
            <td>HP Envy Laptop</td>
            <td>user102</td>
            <td>₱29,500</td>
            <td>June 9, 2025</td>
            <td>12:00 PM</td>
            <td>Pending Payment</td>
          </tr>
        </tbody>
      </table>
    </section>

  </div>
</main>

<!-- Load JS with Thymeleaf resource resolution -->
<script th:src="@{/javascript/Profile.js}" defer></script>
<script th:src="@{/javascript/Admin.js}" defer></script>

</body>
</html>
